# 邀请系统前端更新说明

> 本文档面向全栈工程师，说明前端已完成的邀请系统 UI 更新及后端对接需求。

---

## 一、新增功能概述

本次更新围绕 **邀请裂变** 功能，新增了以下前端 UI 组件和交互入口：

### 1. 邀请信息弹窗 (`InviteShareModal`)

- **功能**：展示用户邀请统计、邀请链接、复制按钮。
- **位置**：`src/app/components/InviteShareModal.tsx`
- **触发入口**：
  - 首页 "告诉你的朋友！" 链接
  - 排行榜页 "邀请" 信息卡片
  - 领取弹窗 "邀请并获得多巴胺！" 按钮
  - 多巴胺指数说明弹窗中的 "邀请并获得多巴胺！" 按钮

### 2. 邀请详情列表弹窗 (`InviteListModal`)

- **功能**：展示用户被邀请人列表及奖励规则说明。
- **位置**：`src/app/components/InviteListModal.tsx`
- **触发入口**：邀请信息弹窗中的 "查看邀请信息" 按钮

### 3. 多巴胺说明弹窗增强 (`InfoPopup`)

- **更新**：当用户点击多巴胺指数时，弹出的说明弹窗底部新增 "邀请并获得多巴胺！" 按钮，点击后打开邀请信息弹窗。

### 4. 排行榜邀请区块优化 (`Leaderboard.tsx`)

- **更新**：邀请统计区块样式重构，显示 "直推 / 间接" 邀请数量，点击打开邀请信息弹窗。

### 5. 领取弹窗增强 (`ClaimModal.tsx`)

- **更新**：
  - 多巴胺指数警告下方新增邀请按钮。
  - 底部新增 "邀请你的朋友！获得额外多巴胺！" 引导文字（可点击）。

---

## 二、当前使用的 Mock 数据

前端目前使用以下**写死数据**，需后端提供对应 API：

| 数据项                    | Mock 值                     | 用途                                     |
| ------------------------- | --------------------------- | ---------------------------------------- |
| `directInvites`           | `12`                        | 用户直接邀请人数                         |
| `indirectInvites`         | `25`                        | 用户间接邀请人数（被邀请人再邀请的人数） |
| `inviteLink`              | `huozhene.io/?invite=1234a` | 用户专属邀请链接                         |
| `inviteList` (Mock Array) | 5 条示例数据                | 邀请详情列表（地址、状态、时间）         |

---

## 三、后端对接需求

### 1. 获取用户邀请统计 API

**建议接口**：`GET /api/user/invite/stats`

**请求**：需携带用户身份（如 JWT 或钱包地址签名）

**响应示例**：

```json
{
  "directInvites": 12,
  "indirectInvites": 25,
  "inviteCode": "1234a"
}
```

---

### 2. 获取用户邀请列表 API

**建议接口**：`GET /api/user/invite/list`

**请求**：需携带用户身份

**响应示例**：

```json
{
  "invites": [
    {
      "address": "0x1234...abcd",
      "status": "active", // active | inactive
      "invitedAt": "2026-01-20T10:00:00Z"
    }
  ]
}
```

---

### 3. 邀请链接规则

前端期望邀请链接格式为：

```
https://huozhene.io/?invite={inviteCode}
```

后端需：

1. 为每个用户生成唯一 `inviteCode`。
2. 当新用户通过带 `?invite=xxx` 的链接注册/激活时，记录邀请关系。

---

### 4. 多巴胺奖励逻辑（建议）

前端已在 UI 中展示以下规则文案：

> 每增加一个被邀请人，多巴胺系数增加 0.1，被邀请人的邀请数量将给你增加 0.01 多巴胺系数

后端需实现：

- 直推奖励：+0.1 多巴胺系数 / 人
- 间接奖励：+0.01 多巴胺系数 / 人

---

## 四、相关文件清单

| 文件                   | 类型 | 说明                            |
| ---------------------- | ---- | ------------------------------- |
| `InviteShareModal.tsx` | 新增 | 邀请信息弹窗                    |
| `InviteListModal.tsx`  | 新增 | 邀请列表弹窗                    |
| `InfoPopup.tsx`        | 修改 | 支持底部按钮插槽                |
| `StatsIndicators.tsx`  | 修改 | 多巴胺说明弹窗增加邀请入口      |
| `Leaderboard.tsx`      | 修改 | 邀请统计区块重构                |
| `ClaimModal.tsx`       | 修改 | 新增邀请引导                    |
| `Home.tsx`             | 修改 | "告诉你的朋友" 改为打开邀请弹窗 |

---

## 五、后续建议

1. **数据联调**：后端完成 API 后，前端替换 Mock 数据为实际 API 调用。
2. **链接生成**：确认邀请链接域名及参数格式。
3. **奖励展示**：如需在弹窗中展示用户因邀请获得的总额外多巴胺，建议 API 返回 `totalBonusDopamine` 字段。
